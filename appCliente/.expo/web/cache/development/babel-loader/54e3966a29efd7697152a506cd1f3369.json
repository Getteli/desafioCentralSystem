{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/var/www/html/desafioCentralSystem/appCliente/pages/Photo.js\";\nimport { StatusBar } from 'expo-status-bar';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigation, StackActions, NavigationActions } from '@react-navigation/native';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport CookieService from \"./../services/CookieService\";\nimport axios from 'axios';\nimport * as Linking from 'expo-linking';\nimport { Camera } from 'expo-camera';\nimport * as FileSystem from 'expo-file-system';\nimport Constants from 'expo-constants';\nimport * as ImagePicker from 'expo-image-picker';\n\nfunction Photo() {\n  var navigation = useNavigation();\n  var cameraReferencia = useRef(null);\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasPermission = _useState2[0],\n      setHasPermission = _useState2[1];\n\n  var _useState3 = useState(Camera.Constants.Type.back),\n      _useState4 = _slicedToArray(_useState3, 2),\n      type = _useState4[0],\n      setType = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      capturedPhoto = _useState6[0],\n      setCapturePhoto = _useState6[1];\n\n  useEffect(function () {\n    if (!CookieService.get(\"email\")) {\n      alert(\"faça login para usar o aplicativo.\");\n      CookieService.remove(\"email\");\n      CookieService.remove(\"access_token\");\n      navigation.reset({\n        index: 0,\n        routes: [{\n          name: 'Home'\n        }]\n      });\n    }\n  }, []);\n  useEffect(function () {\n    (function _callee() {\n      var _await$Camera$request, status;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Camera.requestPermissionsAsync());\n\n            case 2:\n              _await$Camera$request = _context.sent;\n              status = _await$Camera$request.status;\n              setHasPermission(status === 'granted');\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  function takePicture() {\n    var data, database64, localUri, localUri64, filename, _type;\n\n    return _regeneratorRuntime.async(function takePicture$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!cameraReferencia) {\n              _context2.next = 15;\n              break;\n            }\n\n            _context2.next = 3;\n            return _regeneratorRuntime.awrap(cameraReferencia.current.takePictureAsync());\n\n          case 3:\n            data = _context2.sent;\n            _context2.next = 6;\n            return _regeneratorRuntime.awrap(cameraReferencia.current.takePictureAsync({\n              base64: true\n            }));\n\n          case 6:\n            database64 = _context2.sent;\n\n            if (data.uri) {\n              _context2.next = 9;\n              break;\n            }\n\n            return _context2.abrupt(\"return\");\n\n          case 9:\n            localUri = data.uri;\n            localUri64 = database64.base64;\n            filename = localUri.split('/').pop();\n            _type = filename.split('.')[1];\n            _context2.next = 15;\n            return _regeneratorRuntime.awrap(axios.post('http://192.168.1.40:8000/api/photo/post', {\n              data: localUri64,\n              name: filename,\n              type: _type\n            }, {\n              \"headers\": {\n                \"Authorization\": \"Bearer \" + CookieService.get(\"access_token\"),\n                \"content-type\": \"application/json\"\n              }\n            }).then(function (response) {\n              console.log(response.data);\n            }).catch(function (error) {\n              console.log(error);\n            }));\n\n          case 15:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  if (hasPermission === null) {\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 12\n      }\n    });\n  }\n\n  if (hasPermission === false) {\n    return React.createElement(View, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 12\n      }\n    });\n  }\n\n  return React.createElement(React.Fragment, null, React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, React.createElement(Camera, {\n    style: styles.camera,\n    type: type,\n    ref: cameraReferencia,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    style: styles.buttonContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      setType(type === Camera.Constants.Type.back ? Camera.Constants.Type.front : Camera.Constants.Type.back);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 9\n    }\n  }, \"Virar\")))), React.createElement(TouchableOpacity, {\n    style: styles.buttonTake,\n    onPress: takePicture,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }\n  }, \"Tirar Foto\")), React.createElement(TouchableOpacity, {\n    style: styles.buttonTake,\n    onPress: function onPress() {\n      return navigation.goBack();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.text,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 9\n    }\n  }, \"Voltar\"))));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'transparent'\n  },\n  camera: {\n    flex: 1\n  },\n  buttonContainer: {\n    flex: 1,\n    backgroundColor: 'transparent',\n    flexDirection: 'row',\n    margin: 20\n  },\n  button: {\n    flex: 0.1,\n    alignSelf: 'flex-end',\n    alignItems: 'center'\n  },\n  text: {\n    fontSize: 18,\n    width: 50,\n    marginLeft: 20,\n    fontWeight: 'bold',\n    color: 'black'\n  },\n  buttonTake: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#000',\n    color: 'white',\n    margin: 20,\n    height: 50\n  }\n});\nexport default Photo;","map":{"version":3,"sources":["/var/www/html/desafioCentralSystem/appCliente/pages/Photo.js"],"names":["StatusBar","React","useEffect","useState","useRef","useNavigation","StackActions","NavigationActions","CookieService","axios","Linking","Camera","FileSystem","Constants","ImagePicker","Photo","navigation","cameraReferencia","hasPermission","setHasPermission","Type","back","type","setType","capturedPhoto","setCapturePhoto","get","alert","remove","reset","index","routes","name","requestPermissionsAsync","status","takePicture","current","takePictureAsync","data","base64","database64","uri","localUri","localUri64","filename","split","pop","post","then","response","console","log","catch","error","styles","container","camera","buttonContainer","button","front","text","buttonTake","goBack","StyleSheet","create","flex","backgroundColor","flexDirection","margin","alignSelf","alignItems","fontSize","width","marginLeft","fontWeight","color","justifyContent","height"],"mappings":"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","sourcesContent":["import { StatusBar } from 'expo-status-bar';\nimport React, { useEffect, useState, useRef } from 'react';\nimport { useNavigation, StackActions, NavigationActions } from '@react-navigation/native';\nimport { StyleSheet, Text, View, TouchableOpacity } from 'react-native';\nimport CookieService from \"./../services/CookieService\";\nimport axios from 'axios';\nimport * as Linking from 'expo-linking';\n\n// importa a camera\nimport { Camera } from 'expo-camera';\nimport * as FileSystem from 'expo-file-system';\nimport Constants from 'expo-constants';\nimport * as ImagePicker from 'expo-image-picker';\n\nfunction Photo() {\n\n  // button\n  const navigation = useNavigation();\n  const cameraReferencia = useRef(null);\n  const [hasPermission, setHasPermission] = useState(null);\n  const [type, setType] = useState(Camera.Constants.Type.back);\n  const [capturedPhoto, setCapturePhoto] = useState(null);\n\n  useEffect(() => {\n    // verifica se ta logado\n    if (!CookieService.get(\"email\")) {\n      alert(\"faça login para usar o aplicativo.\");\n      // limpa\n      CookieService.remove(\"email\");\n      CookieService.remove(\"access_token\");\n      // limpa e volta a rota\n      navigation.reset({\n          index: 0,\n          routes: [{ name: 'Home' }],\n      });\n    }\n  }, []);\n\n  // verifica e pede permissao de camera\n  useEffect(() => {\n    (async () => {\n      const { status } = await Camera.requestPermissionsAsync();\n      setHasPermission(status === 'granted');\n    })();\n  }, []);\n\n  async function takePicture() {\n    if (cameraReferencia) {\n      // foto com dados\n      const data = await cameraReferencia.current.takePictureAsync();\n      // foto em base64\n      const database64 = await cameraReferencia.current.takePictureAsync({base64: true});\n\n      // se tiver vazio retorna\n      if (!data.uri) {\n        return;\n      }\n\n      // prepara os dados\n      let localUri = data.uri;\n      let localUri64 = database64.base64;\n      let filename = localUri.split('/').pop();\n      let type = filename.split('.')[1];\n\n      // estou passando o base64 image pois o formData nao estava indo\n      // sobe para o servidor a localizacao\n      // ALTERE o host para o ip da maquina, porta 8000 roda o servidor da API\n      await axios.post('http://192.168.1.40:8000/api/photo/post', {\n        data: localUri64,\n        name: filename,\n        type: type\n      },{\n        \"headers\": {\n          \"Authorization\": \"Bearer \" + CookieService.get(\"access_token\"),\n          \"content-type\": \"application/json\",\n        },\n      })\n      .then(function(response) {\n        console.log(response.data);\n      })\n      .catch(function(error) {\n        console.log(error);\n      });\n\n    }\n  }\n\n  if (hasPermission === null) {\n    return <View />;\n  }\n  if (hasPermission === false) {\n    return <View />;\n  }\n\n  return (\n    <>\n      <View style={styles.container}>\n\n      <Camera style={styles.camera} type={type} ref={cameraReferencia}>\n\n      <View style={styles.buttonContainer}>\n      <TouchableOpacity style={styles.button} onPress={() => { setType( type === Camera.Constants.Type.back ? Camera.Constants.Type.front : Camera.Constants.Type.back ); }}>\n        <Text style={styles.text}>Virar</Text>\n      </TouchableOpacity>\n      </View>\n      </Camera>\n      <TouchableOpacity style={styles.buttonTake} onPress={takePicture}>\n        <Text style={styles.text}>Tirar Foto</Text>\n      </TouchableOpacity>\n      <TouchableOpacity style={styles.buttonTake} onPress={() => navigation.goBack()}>\n        <Text style={styles.text}>Voltar</Text>\n      </TouchableOpacity>\n\n      </View>\n    </>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'transparent'\n  },\n  camera: {\n    flex: 1,\n  },\n  buttonContainer: {\n    flex: 1,\n    backgroundColor: 'transparent',\n    flexDirection: 'row',\n    margin: 20,\n  },\n  button: {\n    flex: 0.1,\n    alignSelf: 'flex-end',\n    alignItems: 'center',\n  },\n  text: {\n    fontSize: 18,\n    width: 50,\n    marginLeft: 20,\n    fontWeight: 'bold',\n    color: 'black',\n  },\n  buttonTake: {\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: '#000',\n    color: 'white',\n    margin: 20,\n    height: 50\n  }\n});\n\nexport default Photo;\n"]},"metadata":{},"sourceType":"module"}